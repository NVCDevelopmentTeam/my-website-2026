import{a as N,g as A,P as E}from"../chunks/CH1ZU_-_.js";import{s as O}from"../chunks/6oJg6312.js";import{z as v,p as M,f as j,A as T,g as w,t as F,a as x,b as L,j as o,c as k,u as b,s as u,k as y,r as P,l as K}from"../chunks/DN1fDwAb.js";import{P as q}from"../chunks/BSRy4JJk.js";import{S as B}from"../chunks/CXl__1c6.js";import{g as G}from"../chunks/Cw1OXyQU.js";const H=!0;async function I(){return N().filter(t=>t?.metadata).map(t=>({category:t.metadata.slug}))}async function J({params:d,url:t,depends:r}){r("blog:category");const n=d.category;n||v(400,"Danh mục không hợp lệ.");const c=N().find(e=>e?.metadata?.slug===n);c?.metadata||v(404,`Không tìm thấy danh mục "${n}".`);const s=c.metadata,g=O.pagination.postsPerPage,l=t.searchParams.get("page");let a=Number(l);(!a||a<1)&&(a=1);const p=(a-1)*g;try{const e=await A({offset:p,limit:g,category:s.title}),_=e?.posts??[],f=e?.total??0,m=Math.max(1,e?.totalPages??1);return f===0?{category:s,posts:[],pagination:{currentPage:1,totalPages:1,totalPosts:0,hasPrev:!1,hasNext:!1}}:(a>m&&v(404,`Trang ${a} không tồn tại trong danh mục "${s.title}".`),{category:s,posts:_,pagination:{currentPage:a,totalPages:m,totalPosts:f,hasPrev:a>1,hasNext:a<m}})}catch(e){console.error("Error loading category page:",e),v(500,"Không thể tải bài viết trong danh mục này.")}}const tt=Object.freeze(Object.defineProperty({__proto__:null,entries:I,load:J,prerender:H},Symbol.toStringTag,{value:"Module"}));var Q=k('<!> <div class="mt-12"><!></div>',1),R=k('<p class="text-center text-gray-950 dark:text-gray-50 font-bold italic mt-8">Chưa có posts nào trong danh mục này.</p>'),U=k('<!> <section class="px-4 py-12"><h1 class="text-3xl font-black text-gray-950 dark:text-gray-50"> </h1> <p class="mt-2 text-gray-950 dark:text-gray-50 font-bold"> </p> <!></section>',1);function at(d,t){M(t,!0);let r=b(()=>t.data.category),n=b(()=>t.data.posts);const C=b(()=>G({title:`Danh mục: ${o(r)?.title||"Không xác định"}`,description:o(r)?.description||`Các bài viết thuộc danh mục "${o(r)?.title||"này"}" trên ${O.title}.`,url:`/blog/category/${o(r)?.slug}`}));var c=U(),s=j(c);B(s,T(()=>o(C)));var g=u(s,2),l=y(g),a=y(l,!0);P(l);var p=u(l,2),e=y(p);P(p);var _=u(p,2);{var f=i=>{var h=Q(),S=j(h);q(S,{get posts(){return o(n)}});var D=u(S,2),z=y(D);E(z,{get pagination(){return t.data.pagination}}),P(D),x(i,h)},m=i=>{var h=R();x(i,h)};w(_,i=>{o(n).length>0?i(f):i(m,!1)})}P(g),F(()=>{K(a,o(r)?.title||"Danh mục"),K(e,`Danh mục ${o(r)?.title??""} có ${(t.data.pagination?.totalPosts||0)??""} bài viết`)}),x(d,c),L()}export{at as component,tt as universal};
