import{metadata as E}from"./tuong-lai-nao-cho-nganh-lap-trinh-2025.js";import{s as S}from"./config.js";import{s as p}from"./slugify.js";import{t as C}from"./truncate.js";const x=Object.assign({"/src/lib/contents/posts/tuong-lai-nao-cho-nganh-lap-trinh-2025.md":E});let D=null,v=null,N=null,w=null;const b=36e5;function P(){return w?Date.now()-w>b:!0}function A(){return D&&!P()||(D=Object.entries(x).map(([r,e])=>{const a=r.split("/").pop()?.replace(".md","")||"untitled",t=e||{},s=t.slug||p(a),l=t.title||a,c=t.author||S?.author?.name||"Ẩn danh";let m=t.date;try{const f=new Date(m);isNaN(f.getTime())?m=new Date().toISOString():m=f.toISOString()}catch{m=new Date().toISOString()}let g=[];typeof t.categories=="string"?g=t.categories.split(",").map(f=>f.trim()).filter(Boolean):Array.isArray(t.categories)&&(g=t.categories.filter(Boolean)),g.length===0&&(g=["chưa phân loại"]);let u=[];typeof t.tags=="string"?u=t.tags.split(",").map(f=>f.trim()).filter(Boolean):Array.isArray(t.tags)&&(u=t.tags.filter(Boolean)),u.length===0&&(u=["chưa phân loại"]);const o=t.description&&typeof t.description=="string"&&t.description.trim().length>0&&!t.description.startsWith("title:")&&!t.description.startsWith("---")?C(t.description.trim(),160):C(l,60),d=t.preview&&typeof t.preview=="string"&&t.preview.trim().length>0?t.preview.trim():t.excerpt||o,h=typeof t.readingTime=="number"&&t.readingTime>0?t.readingTime:5;return{slug:s,rawName:a,timestamp:new Date(m).getTime(),metadata:{slug:s,title:l,author:c,date:m,updated:t.updated||m,categories:g,tags:u,description:o,preview:d,readingTime:h,draft:t.draft===!0||t.draft==="true",image:t.image||null,toc:t.toc||[],_wordsCount:t._wordsCount}}}).filter(r=>!r.metadata.draft).sort((r,e)=>e.timestamp-r.timestamp),w=Date.now()),D}function j({offset:n=0,limit:r=S?.pagination?.postsPerPage||10,category:e="",author:a="",tag:t="",year:s=null,month:l=null}={}){let c=A();if(e&&e.trim()){const o=p(e.trim());c=c.filter(i=>i.metadata.categories.some(d=>p(d)===o))}if(a&&a.trim()){const o=a.trim().toLowerCase();c=c.filter(i=>i.metadata.author.toLowerCase()===o)}if(t&&t.trim()){const o=p(t.trim());c=c.filter(i=>i.metadata.tags.some(d=>p(d)===o))}if(s){const o=parseInt(s);isNaN(o)||(c=c.filter(i=>new Date(i.metadata.date).getFullYear()===o))}if(l&&s){const o=parseInt(l),i=parseInt(s);!isNaN(o)&&!isNaN(i)&&(c=c.filter(d=>{const h=new Date(d.metadata.date);return h.getFullYear()===i&&h.getMonth()+1===o}))}const m=c.length,g=Math.ceil(m/r),u=Math.floor(n/r)+1;return{posts:c.slice(n,n+r),total:m,totalPages:g,currentPage:u,limit:r,offset:n,hasNext:n+r<m,hasPrev:n>0,pages:Array.from({length:g},(o,i)=>({number:i+1,offset:i*r,isActive:i+1===u})),filters:{category:e,author:a,tag:t,year:s,month:l}}}function B(n){if(!n)throw new Error("Slug is required");if([".json",".xml",".png",".jpg",".jpeg",".webp",".ico",".txt"].some(s=>n.toLowerCase().endsWith(s)))throw new Error(`Invalid slug (static file): ${n}`);const e=A(),a=p(n),t=e.find(s=>s.slug===a||p(s.rawName)===a);if(!t)throw new Error(`Post not found: ${n}`);return t}function L(){if(v&&!P())return v;const n=A(),r=new Map;return n.forEach(e=>{e.metadata.categories.forEach(a=>{const t=a.trim();if(!t)return;const s=p(t),l=r.get(s);l?l.count++:r.set(s,{title:t,slug:s,count:1})})}),v=Array.from(r.values()).map(({title:e,slug:a,count:t})=>({metadata:{title:e,slug:a,description:`Danh mục ${e} có ${t} bài viết`,count:t}})).sort((e,a)=>a.metadata.count-e.metadata.count),w=Date.now(),v}function O(){if(N&&!P())return N;const n=A(),r=new Map;return n.forEach(e=>{e.metadata.tags.forEach(a=>{const t=a.trim();if(t){const s=p(t),l=r.get(s);l?l.count++:r.set(s,{name:t,slug:s,count:1})}})}),N=Array.from(r.values()).map(({name:e,slug:a,count:t})=>({name:e,count:t,slug:a})).sort((e,a)=>a.count-e.count),w=Date.now(),N}export{L as a,O as b,B as c,j as g};
