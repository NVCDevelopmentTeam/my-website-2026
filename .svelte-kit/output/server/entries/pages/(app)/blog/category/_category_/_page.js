import{a as m,g as u}from"../../../../../../chunks/posts.js";import{s as P}from"../../../../../../chunks/config.js";import{error as r}from"@sveltejs/kit";import{i as y}from"../../../../../../chunks/vendor.js";const k=!0;async function C(){return m().filter(e=>e?.metadata).map(e=>({category:e.metadata.slug}))}async function D({params:g,url:e,depends:p}){p("blog:category");const s=g.category;s||r(400,"Danh mục không hợp lệ.");const i=m().find(a=>a?.metadata?.slug===s);i?.metadata||r(404,`Không tìm thấy danh mục "${s}".`);const o=i.metadata,c=P.pagination.postsPerPage,f=y?null:e.searchParams.get("page");let t=Number(f);(!t||t<1)&&(t=1);const h=(t-1)*c;try{const a=await u({offset:h,limit:c,category:o.title}),d=a?.posts??[],l=a?.total??0,n=Math.max(1,a?.totalPages??1);return l===0?{category:o,posts:[],pagination:{currentPage:1,totalPages:1,totalPosts:0,hasPrev:!1,hasNext:!1}}:(t>n&&r(404,`Trang ${t} không tồn tại trong danh mục "${o.title}".`),{category:o,posts:d,pagination:{currentPage:t,totalPages:n,totalPosts:l,hasPrev:t>1,hasNext:t<n}})}catch(a){console.error("Error loading category page:",a),r(500,"Không thể tải bài viết trong danh mục này.")}}export{C as entries,D as load,k as prerender};
